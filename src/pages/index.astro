---
/**
 * È¶ñÈ°µ - ÊòæÁ§∫ÊâÄÊúâÂèØÁî®ÁöÑÈîôËØØÈ°µÈù¢ÂàóË°®Ôºà‰∏≠ÊñáÔºâ
 */
import GlassLayout from '../layouts/GlassLayout.astro';
import { useTranslations } from '../i18n/utils';

const t = useTranslations('zh');

// Âè™ÊòæÁ§∫Ê†∏ÂøÉÂøÖÈúÄÁöÑÈ°µÈù¢ÔºåÈöêËóèÈáçÂ§çÁöÑÊóßÁâàÈ°µÈù¢
const corePages = [
  { key: 'waf-block', code: '403', type: 'block' },
  { key: 'ip-block', code: '403', type: 'block' },
  { key: 'rate-limit', code: '429', type: 'block' },
  { key: 'interactive-challenge', code: '403', type: 'challenge' },
  { key: 'managed-challenge', code: '403', type: 'challenge' },
  { key: 'country-challenge', code: '403', type: 'challenge' },
  { key: 'javascript-challenge', code: '403', type: 'challenge' },
  { key: '100x', code: '1xxx', type: 'error' },
  { key: '5xx', code: '5xx', type: 'error' },
];

const errorPages = corePages.map((page) => ({
  path: `/${page.key}`,
  title: t.errorPages[page.key].title,
  heading: t.errorPages[page.key].heading,
  code: page.code,
  type: page.type,
}));
---

<GlassLayout title={t.index.title} contentPosition="center">
  <div class="flex flex-col items-center space-y-8">
    <!-- Header -->
    <div class="text-center space-y-4 relative w-full">
      <h1 class="text-3xl md:text-4xl font-extrabold text-transparent bg-clip-text bg-linear-to-r from-blue-600 to-indigo-600 drop-shadow-sm">
        üõ°Ô∏è {t.index.title}
      </h1>
      <div class="flex justify-center space-x-2 z-20">
        <a href="/" class="px-3 py-1 bg-slate-800/10 text-slate-700 rounded-full text-xs font-bold backdrop-blur hover:bg-slate-800/20 transition-colors shadow-sm ring-1 ring-slate-900/5">‰∏≠Êñá</a>
        <a href="/en" class="px-3 py-1 bg-transparent border border-slate-800/20 text-slate-600 rounded-full text-xs font-bold hover:bg-slate-800/10 hover:text-slate-800 transition-colors">English</a>
      </div>
    </div>

    <!-- Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full">
      {
        errorPages.map((page) => (
          <a href={page.path} class="group relative bg-white/60 border border-white/40 rounded-xl p-5 hover:bg-white/80 transition-all duration-300 hover:-translate-y-1 hover:shadow-lg hover:shadow-blue-500/10 overflow-hidden">
            <div class="absolute inset-0 bg-linear-to-br from-blue-500/5 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity"></div>
            <div class="flex items-center justify-between mb-2">
              <span class="inline-block px-2.5 py-0.5 bg-blue-100 text-blue-700 text-[10px] font-bold uppercase tracking-wider rounded-full border border-blue-200">
                  {t.index.badge}
              </span>
              <span class={`px-2 py-0.5 text-[10px] font-mono font-bold rounded ${
                page.type === 'error' ? 'bg-red-100 text-red-700 border border-red-200' :
                page.type === 'block' ? 'bg-orange-100 text-orange-700 border border-orange-200' :
                'bg-yellow-100 text-yellow-700 border border-yellow-200'
              }`}>
                HTTP {page.code}
              </span>
            </div>
            <h2 class="text-lg font-bold text-slate-800 mb-1 group-hover:text-blue-700 transition-colors">{page.title}</h2>
            <p class="text-xs text-slate-500 font-medium group-hover:text-slate-600 transition-colors line-clamp-2">{page.heading}</p>
          </a>
        ))
      }
    </div>
  </div>

  <span slot="footer-left">{t.index.poweredBy}</span>

  <!-- ËØ≠Ë®ÄËá™Âä®Ê£ÄÊµãËÑöÊú¨ -->
  <script>
    function detectAndRedirect() {
      if (window.location.pathname !== '/') return;
      const savedLang = localStorage.getItem('preferredLang');
      if (savedLang) return;
      const browserLang = navigator.language || navigator.languages?.[0];
      if (!browserLang) return;
      const primaryLang = browserLang.split('-')[0].toLowerCase();
      if (primaryLang === 'en') {
        window.location.href = '/en';
      }
    }
    detectAndRedirect();
  </script>
</GlassLayout>
